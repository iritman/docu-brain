# سیستم RAG - بازیابی تقویت‌شده برای تولید پاسخ

## 📋 توضیحات پروژه

این پروژه یک سیستم RAG (Retrieval-Augmented Generation) کامل است که به کاربران امکان آپلود فایل‌های PDF، ایندکس کردن محتوای آن‌ها در یک پایگاه داده برداری، و پرسش از محتوای اسناد را می‌دهد.

## ✨ ویژگی‌های کلیدی

- 📁 **آپلود چندین فایل PDF همزمان**
- 🔍 **جستجوی هوشمند در محتوای اسناد**
- 🧠 **تولید پاسخ با مدل زبانی Gemma 2B**
- 🗂️ **مدیریت فایل‌ها (حذف و انتخاب)**
- 📊 **نمایش آمار سیستم**
- 🌐 **رابط کاربری فارسی و راست‌چین**

## 🛠️ تکنولوژی‌های استفاده‌شده

- **Streamlit**: رابط کاربری
- **FAISS**: پایگاه داده برداری
- **Sentence Transformers**: تولید embedding
- **PyMuPDF**: خواندن فایل‌های PDF
- **OpenRouter API**: دسترسی به مدل Gemma 2B

## 📦 نصب و راه‌اندازی

### 1. کلون کردن پروژه
```bash
git clone <repository-url>
cd research-rag
```

### 2. نصب وابستگی‌ها
```bash
pip install -r requirements.txt
```

### 3. تنظیم متغیرهای محیطی
برای تنظیم مدل زبانی (Ollama یا OpenRouter):

```bash
# کپی کردن فایل نمونه
cp .env.example .env

# ویرایش فایل .env و وارد کردن مقادیر خود
```

**متغیرهای قابل تنظیم:**

#### برای استفاده از Ollama (مدل محلی):
```env
USE_OLLAMA=true
OLLAMA_BASE_URL=http://localhost:11434/api/generate
OLLAMA_MODEL=gemma2:latest
```

#### برای استفاده از OpenRouter (مدل ابری):
```env
USE_OLLAMA=false
OPENROUTER_API_KEY=your-api-key-here
OPENROUTER_MODEL=meta-llama/llama-3.2-3b-instruct:free
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1/chat/completions
```
- `OPENROUTER_MODEL`: مدل مورد استفاده
- `OPENROUTER_BASE_URL`: آدرس پایه API

### 4. اجرای اپلیکیشن
```bash
streamlit run app.py
```

## 🚀 نحوه استفاده

### 1. آپلود فایل‌ها
- فایل‌های PDF خود را در بخش "آپلود فایل‌های PDF" انتخاب کنید
- روی دکمه "پردازش" کلیک کنید
- منتظر بمانید تا فایل پردازش و ایندکس شود

### 2. انتخاب منابع
- در بخش "مدیریت فایل‌های آپلودشده" فایل‌هایی که می‌خواهید در آن‌ها جستجو کنید را انتخاب کنید

### 3. پرسش از اسناد
- سؤال خود را در باکس متنی وارد کنید
- روی دکمه "جستجو و پاسخ" کلیک کنید
- پاسخ تولیدشده و منابع استفاده‌شده را مشاهده کنید

## 📁 ساختار پروژه

```
research-rag/
├── app.py                 # فایل اصلی اپلیکیشن
├── requirements.txt       # وابستگی‌های پروژه
├── data/                  # پوشه ذخیره فایل‌ها و پایگاه داده
│   ├── *.pdf             # فایل‌های PDF آپلودشده
│   └── vector_db.pkl     # پایگاه داده برداری
└── README.md             # راهنمای پروژه
```

## ⚙️ تنظیمات

### API Key
کلید API در فایل `app.py` تعریف شده است. در صورت نیاز می‌توانید آن را تغییر دهید:

```python
self.api_key = "sk-or-v1-a7657adbc480f60151114f7378540c4"
```

### تنظیمات چانک
اندازه چانک‌ها و میزان همپوشانی در کلاس `DocumentProcessor` قابل تنظیم است:

```python
self.chunk_size = 500      # اندازه هر چانک
self.chunk_overlap = 50    # میزان همپوشانی
```

## 🔧 عیب‌یابی

### مشکلات رایج:

1. **خطا در نصب FAISS**: اطمینان حاصل کنید که Python 3.8+ نصب است
2. **خطا در خواندن PDF**: فایل PDF معتبر و غیر رمزگذاری‌شده باشد
3. **خطا در API**: اتصال اینترنت و صحت کلید API را بررسی کنید

## 📝 نکات مهم

- فایل‌های PDF باید غیر رمزگذاری‌شده باشند
- حداکثر اندازه فایل توصیه‌شده: 50MB
- برای بهترین نتایج، اسناد باید دارای متن قابل استخراج باشند
- پایگاه داده برداری به صورت خودکار ذخیره و بازیابی می‌شود

## 🤝 مشارکت

برای مشارکت در این پروژه:
1. Fork کنید
2. شاخه جدید ایجاد کنید
3. تغییرات خود را commit کنید
4. Pull Request ارسال کنید

## 📄 مجوز

این پروژه تحت مجوز MIT منتشر شده است.

---

**نکته**: این پروژه یک نسخه MVP است و برای استفاده در محیط تولید نیاز به بهینه‌سازی‌های بیشتری دارد.